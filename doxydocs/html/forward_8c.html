<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>OpenVPN: src/openvpn/forward.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">forward.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="syshead_8h_source.html">syshead.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="forward_8h_source.html">forward.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="init_8h_source.html">init.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="push_8h_source.html">push.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gremlin_8h_source.html">gremlin.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mss_8h_source.html">mss.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="event_8h_source.html">event.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ps_8h_source.html">ps.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dhcp_8h_source.html">dhcp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ssl__verify_8h_source.html">ssl_verify.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memdbg_8h_source.html">memdbg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="forward-inline_8h_source.html">forward-inline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="occ-inline_8h_source.html">occ-inline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ping-inline_8h_source.html">ping-inline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mstats_8h_source.html">mstats.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for forward.c:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c__incl.png" border="0" usemap="#src_2openvpn_2forward_8c" alt=""/></div>
<map name="src_2openvpn_2forward_8c" id="src_2openvpn_2forward_8c">
<area shape="rect" id="node2" href="syshead_8h.html" title="syshead.h" alt="" coords="312,453,395,480"/>
<area shape="rect" id="node5" href="forward_8h.html" title="forward.h" alt="" coords="1633,80,1708,107"/>
<area shape="rect" id="node10" href="common_8h.html" title="common.h" alt="" coords="1129,827,1212,853"/>
<area shape="rect" id="node14" href="event_8h.html" title="event.h" alt="" coords="1573,752,1635,779"/>
<area shape="rect" id="node38" href="init_8h.html" title="init.h" alt="" coords="1481,229,1532,256"/>
<area shape="rect" id="node39" href="push_8h.html" title="push.h" alt="" coords="1863,80,1924,107"/>
<area shape="rect" id="node40" href="gremlin_8h.html" title="gremlin.h" alt="" coords="1948,80,2023,107"/>
<area shape="rect" id="node41" href="mss_8h.html" title="mss.h" alt="" coords="284,677,343,704"/>
<area shape="rect" id="node42" href="ps_8h.html" title="ps.h" alt="" coords="2047,80,2094,107"/>
<area shape="rect" id="node43" href="dhcp_8h.html" title="dhcp.h" alt="" coords="519,677,580,704"/>
<area shape="rect" id="node44" href="ssl__verify_8h.html" title="ssl_verify.h" alt="" coords="259,379,344,405"/>
<area shape="rect" id="node46" href="memdbg_8h.html" title="memdbg.h" alt="" coords="2119,80,2201,107"/>
<area shape="rect" id="node47" href="forward-inline_8h.html" title="forward&#45;inline.h" alt="" coords="2226,80,2334,107"/>
<area shape="rect" id="node48" href="occ-inline_8h.html" title="occ&#45;inline.h" alt="" coords="2359,80,2447,107"/>
<area shape="rect" id="node49" href="ping-inline_8h.html" title="ping&#45;inline.h" alt="" coords="2471,80,2561,107"/>
<area shape="rect" id="node50" href="mstats_8h.html" title="mstats.h" alt="" coords="2586,80,2659,107"/>
<area shape="rect" id="node3" href="compat_8h.html" title="compat.h" alt="" coords="267,528,343,555"/>
<area shape="rect" id="node6" href="openvpn_8h.html" title="openvpn.h" alt="" coords="1249,304,1329,331"/>
<area shape="rect" id="node36" href="occ_8h.html" title="occ.h" alt="" coords="1678,155,1733,181"/>
<area shape="rect" id="node37" href="ping_8h.html" title="ping.h" alt="" coords="1545,155,1602,181"/>
<area shape="rect" id="node7" href="buffer_8h.html" title="buffer.h" alt="" coords="679,827,742,853"/>
<area shape="rect" id="node9" href="options_8h.html" title="options.h" alt="" coords="1057,528,1132,555"/>
<area shape="rect" id="node11" href="route_8h.html" title="route.h" alt="" coords="1227,603,1290,629"/>
<area shape="rect" id="node12" href="tun_8h.html" title="tun.h" alt="" coords="1343,677,1393,704"/>
<area shape="rect" id="node15" href="sig_8h.html" title="sig.h" alt="" coords="1636,827,1687,853"/>
<area shape="rect" id="node16" href="status_8h.html" title="status.h" alt="" coords="1668,901,1737,928"/>
<area shape="rect" id="node17" href="interval_8h.html" title="interval.h" alt="" coords="1702,976,1775,1003"/>
<area shape="rect" id="node20" href="misc_8h.html" title="misc.h" alt="" coords="1140,752,1201,779"/>
<area shape="rect" id="node21" href="socket_8h.html" title="socket.h" alt="" coords="939,603,1011,629"/>
<area shape="rect" id="node22" href="proxy_8h.html" title="proxy.h" alt="" coords="799,677,863,704"/>
<area shape="rect" id="node23" href="socks_8h.html" title="socks.h" alt="" coords="655,677,723,704"/>
<area shape="rect" id="node24" href="plugin_8h.html" title="plugin.h" alt="" coords="1136,603,1203,629"/>
<area shape="rect" id="node25" href="manage_8h.html" title="manage.h" alt="" coords="1366,603,1445,629"/>
<area shape="rect" id="node26" href="comp_8h.html" title="comp.h" alt="" coords="1469,603,1534,629"/>
<area shape="rect" id="node27" href="crypto_8h.html" title="crypto.h" alt="" coords="572,528,641,555"/>
<area shape="rect" id="node28" href="packet__id_8h.html" title="packet_id.h" alt="" coords="602,603,691,629"/>
<area shape="rect" id="node29" href="ssl_8h.html" title="ssl.h" alt="" coords="743,379,793,405"/>
<area shape="rect" id="node31" href="fragment_8h.html" title="fragment.h" alt="" coords="868,379,951,405"/>
<area shape="rect" id="node32" href="shaper_8h.html" title="shaper.h" alt="" coords="975,379,1046,405"/>
<area shape="rect" id="node33" href="mbuf_8h.html" title="mbuf.h" alt="" coords="1071,379,1132,405"/>
<area shape="rect" id="node34" href="pool_8h.html" title="pool.h" alt="" coords="1157,379,1214,405"/>
<area shape="rect" id="node35" href="pf_8h.html" title="pf.h" alt="" coords="1239,379,1281,405"/>
<area shape="rect" id="node8" href="error_8h.html" title="error.h" alt="" coords="541,901,600,928"/>
<area shape="rect" id="node13" href="win32_8h.html" title="win32.h" alt="" coords="1500,901,1567,928"/>
<area shape="rect" id="node19" href="proto_8h.html" title="proto.h" alt="" coords="799,752,862,779"/>
<area shape="rect" id="node18" href="perf_8h.html" title="perf.h" alt="" coords="1506,827,1561,853"/>
<area shape="rect" id="node30" href="ssl__common_8h.html" title="ssl_common.h" alt="" coords="672,453,779,480"/>
<area shape="rect" id="node45" href="ssl__verify__backend_8h.html" title="ssl_verify_backend.h" alt="" coords="94,453,237,480"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa69b8ddc8529422bd57a2f0ac4dc1baa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#aa69b8ddc8529422bd57a2f0ac4dc1baa">check_tls_dowork</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:aa69b8ddc8529422bd57a2f0ac4dc1baa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0220d3e3e52a6ed3a07223baf8ec3118"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a0220d3e3e52a6ed3a07223baf8ec3118">check_tls_errors_co</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a0220d3e3e52a6ed3a07223baf8ec3118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bdb78059db1c838ff763037eed2e5d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a5bdb78059db1c838ff763037eed2e5d6">check_tls_errors_nco</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a5bdb78059db1c838ff763037eed2e5d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af22e6b17de9f4a9c73f5f68c867a4ee6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#af22e6b17de9f4a9c73f5f68c867a4ee6">check_connection_established_dowork</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:af22e6b17de9f4a9c73f5f68c867a4ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a409db050be184362b60f3ce7b56b35"><td class="memItemLeft" align="right" valign="top"><a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a> (struct <a class="el" href="structcontext.html">context</a> *c, const char *str, int msglevel)</td></tr>
<tr class="separator:a7a409db050be184362b60f3ce7b56b35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e05ddb37e7fa8d9077fe61646be42b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a7e05ddb37e7fa8d9077fe61646be42b4">check_add_routes_dowork</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a7e05ddb37e7fa8d9077fe61646be42b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aed8bd2612723013ba541ee7f308cea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a4aed8bd2612723013ba541ee7f308cea">check_inactivity_timeout_dowork</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a4aed8bd2612723013ba541ee7f308cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1445427854d7b321be538f18802b6b35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a1445427854d7b321be538f18802b6b35">get_server_poll_remaining_time</a> (struct <a class="el" href="structevent__timeout.html">event_timeout</a> *server_poll_timeout)</td></tr>
<tr class="separator:a1445427854d7b321be538f18802b6b35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c98f9f6ed23e51304e14e1f41301be3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a8c98f9f6ed23e51304e14e1f41301be3">check_status_file_dowork</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a8c98f9f6ed23e51304e14e1f41301be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66abf1cd0cfe2af99b61d954cab37966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a66abf1cd0cfe2af99b61d954cab37966">encrypt_sign</a> (struct <a class="el" href="structcontext.html">context</a> *c, <a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> comp_frag)</td></tr>
<tr class="separator:a66abf1cd0cfe2af99b61d954cab37966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab240cf830443447e24d8554e7b290446"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#ab240cf830443447e24d8554e7b290446">read_incoming_link</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:ab240cf830443447e24d8554e7b290446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01bb4da24c0d75c32845ac87c5cad055"><td class="memItemLeft" align="right" valign="top"><a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a01bb4da24c0d75c32845ac87c5cad055">process_incoming_link_part1</a> (struct <a class="el" href="structcontext.html">context</a> *c, struct <a class="el" href="structlink__socket__info.html">link_socket_info</a> *lsi, <a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> floated)</td></tr>
<tr class="separator:a01bb4da24c0d75c32845ac87c5cad055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28085fcbafd6f128240d96026fd81414"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a28085fcbafd6f128240d96026fd81414">process_incoming_link_part2</a> (struct <a class="el" href="structcontext.html">context</a> *c, struct <a class="el" href="structlink__socket__info.html">link_socket_info</a> *lsi, const uint8_t *orig_buf)</td></tr>
<tr class="separator:a28085fcbafd6f128240d96026fd81414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a085f2884d6c0e63250ad17e489ab2a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a085f2884d6c0e63250ad17e489ab2a1e">read_incoming_tun</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a085f2884d6c0e63250ad17e489ab2a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac8de3ee1c24f16d30a8773d7574bee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a1ac8de3ee1c24f16d30a8773d7574bee">process_incoming_tun</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a1ac8de3ee1c24f16d30a8773d7574bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d9ddd3cb647f519e56209e58fb09610"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a9d9ddd3cb647f519e56209e58fb09610">process_ip_header</a> (struct <a class="el" href="structcontext.html">context</a> *c, unsigned int flags, struct <a class="el" href="structbuffer.html">buffer</a> *buf)</td></tr>
<tr class="separator:a9d9ddd3cb647f519e56209e58fb09610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a506b271590be59a1b285c6cd4a5d85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a1a506b271590be59a1b285c6cd4a5d85">process_outgoing_link</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a1a506b271590be59a1b285c6cd4a5d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd6f53fabe65e8e50eafc12030a8a6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a2dd6f53fabe65e8e50eafc12030a8a6e">process_outgoing_tun</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a2dd6f53fabe65e8e50eafc12030a8a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c3703dd840bdc9affca78d893d5024"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a98c3703dd840bdc9affca78d893d5024">pre_select</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a98c3703dd840bdc9affca78d893d5024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae89a1b8349579eb1913fe65253ac81a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#ae89a1b8349579eb1913fe65253ac81a1">io_wait_dowork</a> (struct <a class="el" href="structcontext.html">context</a> *c, const unsigned int flags)</td></tr>
<tr class="separator:ae89a1b8349579eb1913fe65253ac81a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20db9c6797042b6584e95af8ea5bbc10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a20db9c6797042b6584e95af8ea5bbc10">process_io</a> (struct <a class="el" href="structcontext.html">context</a> *c)</td></tr>
<tr class="separator:a20db9c6797042b6584e95af8ea5bbc10"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae0b0b85c9002d7df1fc4de4352a7c3e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#ae0b0b85c9002d7df1fc4de4352a7c3e6">link_read_bytes_global</a></td></tr>
<tr class="separator:ae0b0b85c9002d7df1fc4de4352a7c3e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd9d43482b20b7440a8d265c611a35c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forward_8c.html#a0bd9d43482b20b7440a8d265c611a35c">link_write_bytes_global</a></td></tr>
<tr class="separator:a0bd9d43482b20b7440a8d265c611a35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7e05ddb37e7fa8d9077fe61646be42b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_add_routes_dowork </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a7e05ddb37e7fa8d9077fe61646be42b4_cgraph.png" border="0" usemap="#forward_8c_a7e05ddb37e7fa8d9077fe61646be42b4_cgraph" alt=""/></div>
<map name="forward_8c_a7e05ddb37e7fa8d9077fe61646be42b4_cgraph" id="forward_8c_a7e05ddb37e7fa8d9077fe61646be42b4_cgraph">
<area shape="rect" id="node2" href="interval_8c.html#a97d818630ab2bcfe0d44165164cd53c4" title="event_timeout_trigger" alt="" coords="229,5,375,32"/>
<area shape="rect" id="node3" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="249,56,355,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af22e6b17de9f4a9c73f5f68c867a4ee6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_connection_established_dowork </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_af22e6b17de9f4a9c73f5f68c867a4ee6_cgraph.png" border="0" usemap="#forward_8c_af22e6b17de9f4a9c73f5f68c867a4ee6_cgraph" alt=""/></div>
<map name="forward_8c_af22e6b17de9f4a9c73f5f68c867a4ee6_cgraph" id="forward_8c_af22e6b17de9f4a9c73f5f68c867a4ee6_cgraph">
<area shape="rect" id="node2" href="interval_8c.html#a97d818630ab2bcfe0d44165164cd53c4" title="event_timeout_trigger" alt="" coords="253,667,399,693"/>
<area shape="rect" id="node3" href="init_8c.html#a5eea9a05e4580cb48e8b0daad33c59fe" title="reset_coarse_timers" alt="" coords="453,717,593,744"/>
<area shape="rect" id="node4" href="init_8c.html#a9b053b7a612943b6be1d1be2c25181bf" title="do_up" alt="" coords="297,768,355,795"/>
<area shape="rect" id="node5" href="init_8c.html#af461b176774f98425ec61cc176f0ec7c" title="do_deferred_options" alt="" coords="454,768,593,795"/>
<area shape="rect" id="node39" href="manage_8c.html#af07a56f96cec84856d0bf97899a4d460" title="management_sleep" alt="" coords="456,819,591,845"/>
<area shape="rect" id="node40" href="init_8c.html#a0efe2bfd4ac02795b81d7aafe116fd25" title="initialization_sequence\l_completed" alt="" coords="447,906,600,947"/>
<area shape="rect" id="node6" href="init_8c.html#a164331d37fecc9ad095eae0e8dce53de" title="init_verb_mute" alt="" coords="682,717,787,744"/>
<area shape="rect" id="node10" href="socket_8c.html#a86424bdc75e8f05f00a649f30f897110" title="proto_is_udp" alt="" coords="687,768,783,795"/>
<area shape="rect" id="node11" href="socket_8c.html#a022b67c8749e8a934063231b2abc5cf6" title="link_socket_update\l_buffer_sizes" alt="" coords="667,819,802,861"/>
<area shape="rect" id="node12" href="socket_8c.html#a47f7e875f90faefaede7148a7e5f3347" title="link_socket_update\l_flags" alt="" coords="667,885,802,926"/>
<area shape="rect" id="node13" href="ssl_8c.html#ad14c353d14b7dd52a4b78bf75a6c781d" title="tls_poor_mans_ncp" alt="" coords="667,77,802,104"/>
<area shape="rect" id="node17" href="ssl_8c.html#a0f5995c0fcacdedefcc4a7c42a7f18de" title="tls_session_update\l_crypto_params" alt="" coords="667,507,802,549"/>
<area shape="rect" id="node7" href="error_8c.html#ab76eae70d91e60b44b8c6478c72baae5" title="set_check_status" alt="" coords="882,819,1007,845"/>
<area shape="rect" id="node8" href="error_8c.html#af250e34abb4c2f896fcfa37e10aaeebf" title="set_debug_level" alt="" coords="887,768,1002,795"/>
<area shape="rect" id="node9" href="error_8c.html#aa24606a2ec1cb6e454a387c4fd709545" title="set_mute_cutoff" alt="" coords="887,717,1002,744"/>
<area shape="rect" id="node14" href="ssl_8c.html#a9e8061a56d8a114317b5f829b6cbf19b" title="tls_item_in_cipher_list" alt="" coords="869,77,1020,104"/>
<area shape="rect" id="node15" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca" title="string_alloc" alt="" coords="1106,5,1194,32"/>
<area shape="rect" id="node16" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="1433,201,1515,228"/>
<area shape="rect" id="node18" href="crypto_8c.html#a5657fa40c2ed8eed4ac057b87902100b" title="init_key_type" alt="" coords="895,388,994,415"/>
<area shape="rect" id="node24" href="crypto__backend_8h.html#ac7b89b85b5ca673849476a67325d5e84" title="cipher_kt_mode_ofb_cfb" alt="" coords="1069,579,1231,605"/>
<area shape="rect" id="node28" href="crypto_8c.html#aec68a44ce58275f8f5c90363ea527288" title="crypto_max_overhead" alt="" coords="871,515,1019,541"/>
<area shape="rect" id="node29" href="crypto_8c.html#af597e0d765df961d66a200fa33ba4faf" title="crypto_adjust_frame\l_parameters" alt="" coords="875,150,1014,191"/>
<area shape="rect" id="node32" href="mtu_8c.html#aa4f19c6314a87fa7a3616fec2a3f1d32" title="frame_finalize" alt="" coords="894,616,995,643"/>
<area shape="rect" id="node33" href="mtu_8c.html#a224812036cf5be8e57a95dad7d45067e" title="frame_print" alt="" coords="1107,629,1193,656"/>
<area shape="rect" id="node37" href="mtu_8c.html#abf74c37a0e444f337bb18382ff84321b" title="frame_init_mssfix" alt="" coords="883,667,1006,693"/>
<area shape="rect" id="node19" href="crypto__backend_8h.html#abd78a666624a9f587aa03aa446dffdb2" title="cipher_kt_get" alt="" coords="1100,528,1200,555"/>
<area shape="rect" id="node20" href="crypto_8c.html#a01bd87aec788950f324c6e4356dd1790" title="translate_cipher_name\l_from_openvpn" alt="" coords="1073,259,1227,301"/>
<area shape="rect" id="node21" href="crypto__backend_8h.html#a7f36be41d0b97d8e3d9e8d586c2213e4" title="cipher_kt_key_size" alt="" coords="1083,325,1217,352"/>
<area shape="rect" id="node22" href="crypto__backend_8h.html#a21c134671c60f2bc399a5b5a76d7e084" title="cipher_kt_mode_aead" alt="" coords="1075,208,1225,235"/>
<area shape="rect" id="node23" href="crypto__backend_8h.html#a1ab5e0809fe8a98c6ad485c1bc730f80" title="cipher_kt_mode_cbc" alt="" coords="1079,376,1221,403"/>
<area shape="rect" id="node25" href="crypto__backend_8h.html#a5b2de050c2b6a78320fbed2340b25c60" title="cipher_kt_block_size" alt="" coords="1078,157,1222,184"/>
<area shape="rect" id="node26" href="crypto__backend_8h.html#a9cbbade2b528fe5d1e6ae65bbaf1e765" title="md_kt_get" alt="" coords="1109,427,1191,453"/>
<area shape="rect" id="node27" href="crypto__backend_8h.html#a002732eb1e19865cdb8f49a46af2cf69" title="md_kt_size" alt="" coords="1105,477,1195,504"/>
<area shape="rect" id="node30" href="crypto__backend_8h.html#a902518439f09e88281986ebda8dd458b" title="cipher_kt_iv_size" alt="" coords="1089,107,1211,133"/>
<area shape="rect" id="node31" href="crypto__backend_8h.html#a04e1e83fd4bbaac94f1cd7ec40ab1d6b" title="cipher_kt_tag_size" alt="" coords="1085,56,1215,83"/>
<area shape="rect" id="node34" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="1280,317,1375,344"/>
<area shape="rect" id="node36" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="1290,629,1365,656"/>
<area shape="rect" id="node35" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="1423,317,1525,344"/>
<area shape="rect" id="node38" href="mtu_8c.html#a0d975207c7e52a23853613dd18a6eebf" title="frame_set_mtu_dynamic" alt="" coords="1068,680,1232,707"/>
<area shape="rect" id="node41" href="ssl_8c.html#a70374b350883a042a4474de772edbddf" title="delayed_auth_pass_purge" alt="" coords="648,951,821,977"/>
<area shape="rect" id="node42" href="misc_8c.html#a37c9ea488f35dc0454dbf94f7e8938fa" title="purge_user_pass" alt="" coords="884,951,1005,977"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4aed8bd2612723013ba541ee7f308cea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_inactivity_timeout_dowork </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a4aed8bd2612723013ba541ee7f308cea_cgraph.png" border="0" usemap="#forward_8c_a4aed8bd2612723013ba541ee7f308cea_cgraph" alt=""/></div>
<map name="forward_8c_a4aed8bd2612723013ba541ee7f308cea_cgraph" id="forward_8c_a4aed8bd2612723013ba541ee7f308cea_cgraph">
<area shape="rect" id="node2" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="217,13,324,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8c98f9f6ed23e51304e14e1f41301be3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_status_file_dowork </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a8c98f9f6ed23e51304e14e1f41301be3_cgraph.png" border="0" usemap="#forward_8c_a8c98f9f6ed23e51304e14e1f41301be3_cgraph" alt=""/></div>
<map name="forward_8c_a8c98f9f6ed23e51304e14e1f41301be3_cgraph" id="forward_8c_a8c98f9f6ed23e51304e14e1f41301be3_cgraph">
<area shape="rect" id="node2" href="sig_8c.html#ab24d8ba0a87e34d962d54e377a1f9858" title="print_status" alt="" coords="224,81,315,108"/>
<area shape="rect" id="node3" href="status_8c.html#ac13471945270b543de32396a7f03c4bb" title="status_reset" alt="" coords="363,5,457,32"/>
<area shape="rect" id="node4" href="status_8c.html#a8d855058c1a32820d55c92ecee2289cd" title="status_printf" alt="" coords="363,56,457,83"/>
<area shape="rect" id="node7" href="otime_8c.html#a3235fa9248297a37174fafc4522bdbac" title="time_string" alt="" coords="367,107,453,133"/>
<area shape="rect" id="node14" href="status_8c.html#aa7e4814a0ab9d168a9b8902c65932e62" title="status_flush" alt="" coords="364,157,456,184"/>
<area shape="rect" id="node5" href="buffer_8c.html#a6752d536938b11aa1ced5549a1cf3c7e" title="chomp" alt="" coords="523,5,584,32"/>
<area shape="rect" id="node6" href="buffer_8c.html#a0dfcbda5f8696795915dd592ee27a812" title="rm_trailing_chars" alt="" coords="649,5,771,32"/>
<area shape="rect" id="node8" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="506,56,601,83"/>
<area shape="rect" id="node11" href="compat-gettimeofday_8c.html#a2f316a4ad94a242df56b01953677015d" title="gettimeofday" alt="" coords="505,107,601,133"/>
<area shape="rect" id="node12" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="516,157,591,184"/>
<area shape="rect" id="node13" href="buffer_8c.html#ac1a4a1c2b916dd6872a12d3c65506960" title="buf_rmtail" alt="" coords="514,208,593,235"/>
<area shape="rect" id="node9" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="659,56,761,83"/>
<area shape="rect" id="node10" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="669,107,751,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa69b8ddc8529422bd57a2f0ac4dc1baa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_tls_dowork </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_aa69b8ddc8529422bd57a2f0ac4dc1baa_cgraph.png" border="0" usemap="#forward_8c_aa69b8ddc8529422bd57a2f0ac4dc1baa_cgraph" alt=""/></div>
<map name="forward_8c_aa69b8ddc8529422bd57a2f0ac4dc1baa_cgraph" id="forward_8c_aa69b8ddc8529422bd57a2f0ac4dc1baa_cgraph">
<area shape="rect" id="node2" href="ssl_8c.html#ab403d9453e1b8088a89f06537ee74fcb" title="tls_multi_process" alt="" coords="180,81,304,108"/>
<area shape="rect" id="node14" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="189,132,295,159"/>
<area shape="rect" id="node3" href="ssl__backend_8h.html#a163fa38939865554f4d7160a0e426b17" title="tls_clear_error" alt="" coords="381,5,485,32"/>
<area shape="rect" id="node4" href="session__id_8c.html#aa7884bbdd976e0582af7ce08249a5688" title="session_id_print" alt="" coords="375,56,491,83"/>
<area shape="rect" id="node5" href="socket_8c.html#aefe5013514f1d62a138107fb43cc74e3" title="print_link_socket_actual" alt="" coords="352,107,515,133"/>
<area shape="rect" id="node13" href="ssl__verify_8c.html#ac6de478954452cfd54e8352f57638772" title="tls_authentication\l_status" alt="" coords="371,158,495,199"/>
<area shape="rect" id="node6" href="socket_8c.html#aa401d7e395acdc1d4f61f6526ef92846" title="print_link_socket_actual_ex" alt="" coords="563,107,745,133"/>
<area shape="rect" id="node7" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="969,56,1064,83"/>
<area shape="rect" id="node10" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="979,157,1054,184"/>
<area shape="rect" id="node11" href="socket_8c.html#a616cfadfd81ab5ba341fa3adb1e93788" title="print_sockaddr_ex" alt="" coords="793,107,921,133"/>
<area shape="rect" id="node8" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="1112,31,1215,57"/>
<area shape="rect" id="node9" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="1123,81,1204,108"/>
<area shape="rect" id="node12" href="buffer_8c.html#a3856237f6bda0d132ed555c23f3b8968" title="buf_puts" alt="" coords="981,107,1052,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0220d3e3e52a6ed3a07223baf8ec3118"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_tls_errors_co </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a0220d3e3e52a6ed3a07223baf8ec3118_cgraph.png" border="0" usemap="#forward_8c_a0220d3e3e52a6ed3a07223baf8ec3118_cgraph" alt=""/></div>
<map name="forward_8c_a0220d3e3e52a6ed3a07223baf8ec3118_cgraph" id="forward_8c_a0220d3e3e52a6ed3a07223baf8ec3118_cgraph">
<area shape="rect" id="node2" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="192,5,299,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5bdb78059db1c838ff763037eed2e5d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_tls_errors_nco </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a5bdb78059db1c838ff763037eed2e5d6_cgraph.png" border="0" usemap="#forward_8c_a5bdb78059db1c838ff763037eed2e5d6_cgraph" alt=""/></div>
<map name="forward_8c_a5bdb78059db1c838ff763037eed2e5d6_cgraph" id="forward_8c_a5bdb78059db1c838ff763037eed2e5d6_cgraph">
<area shape="rect" id="node2" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="200,5,307,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a66abf1cd0cfe2af99b61d954cab37966"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void encrypt_sign </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>comp_frag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process a data channel packet that will be sent through a VPN tunnel.</p>
<p>This function controls the processing of a data channel packet which will be sent through a VPN tunnel to a remote OpenVPN peer. It's general structure is as follows:</p><ul>
<li>Check that the client authentication has succeeded; if not, drop the packet.</li>
<li>If the <em>comp_frag</em> argument is true:<ul>
<li>Call <code>lzo_compress()</code> of the <a class="el" href="">Channel Compression module</a> to (possibly) compress the packet.</li>
<li>Call <code>fragment_outgoing()</code> of the <a class="el" href="">Channel Fragmentation module</a> to (possibly) fragment the packet.</li>
</ul>
</li>
<li>Activate the <a class="el" href="">Channel Crypto module</a> to perform security operations on the packet.<ul>
<li>Call <code><a class="el" href="group__data__crypto.html#gaba03eaba587a89c2abda8780da7b3ac7">tls_pre_encrypt()</a></code> to choose the appropriate security parameters for this packet.</li>
<li>Call <code><a class="el" href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9">openvpn_encrypt()</a></code> to encrypt and HMAC signed the packet.</li>
<li>Call <code><a class="el" href="group__data__crypto.html#ga1f2ecd39b88da77b2f8067962155ea82">tls_post_encrypt()</a></code> to prepend the one-byte OpenVPN header and do some TLS accounting.</li>
</ul>
</li>
<li>Place the resulting packet in <code>c-&gt;c2.to_link</code> so that it can be sent over the external network interface to its remote destination by the <a class="el" href="">External Multiplexer</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure of the VPN tunnel associated with this packet. </td></tr>
    <tr><td class="paramname">comp_frag</td><td>- Whether to do packet compression and fragmentation. This flag is set to true the first time a packet is processed. If the packet then gets fragmented, this function will be called again once for each remaining fragment with this parameter set to false. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a66abf1cd0cfe2af99b61d954cab37966_cgraph.png" border="0" usemap="#forward_8c_a66abf1cd0cfe2af99b61d954cab37966_cgraph" alt=""/></div>
<map name="forward_8c_a66abf1cd0cfe2af99b61d954cab37966_cgraph" id="forward_8c_a66abf1cd0cfe2af99b61d954cab37966_cgraph">
<area shape="rect" id="node2" href="group__data__crypto.html#gaba03eaba587a89c2abda8780da7b3ac7" title="tls_pre_encrypt" alt="" coords="173,5,283,32"/>
<area shape="rect" id="node3" href="group__data__crypto.html#gad27b20736f89d38d0d2e0c2e35f7a0e3" title="tls_prepend_opcode_v2" alt="" coords="149,56,307,83"/>
<area shape="rect" id="node4" href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9" title="openvpn_encrypt" alt="" coords="169,107,287,133"/>
<area shape="rect" id="node7" href="group__data__crypto.html#gaac2b3aa2c842a102804be65f28adf4b1" title="tls_prepend_opcode_v1" alt="" coords="149,157,307,184"/>
<area shape="rect" id="node8" href="group__data__crypto.html#ga1f2ecd39b88da77b2f8067962155ea82" title="tls_post_encrypt" alt="" coords="169,208,287,235"/>
<area shape="rect" id="node5" href="crypto__backend_8h.html#a56d0dd0253f889a5305beb86d2900fe7" title="cipher_ctx_get_cipher_kt" alt="" coords="355,81,521,108"/>
<area shape="rect" id="node6" href="crypto__backend_8h.html#a21c134671c60f2bc399a5b5a76d7e084" title="cipher_kt_mode_aead" alt="" coords="363,132,513,159"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a66abf1cd0cfe2af99b61d954cab37966_icgraph.png" border="0" usemap="#forward_8c_a66abf1cd0cfe2af99b61d954cab37966_icgraph" alt=""/></div>
<map name="forward_8c_a66abf1cd0cfe2af99b61d954cab37966_icgraph" id="forward_8c_a66abf1cd0cfe2af99b61d954cab37966_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a1ac8de3ee1c24f16d30a8773d7574bee" title="process_incoming_tun" alt="" coords="159,5,311,32"/>
<area shape="rect" id="node4" href="occ_8c.html#aa2d19601aa35014bd3c32bbac4eaeab7" title="check_send_occ_msg\l_dowork" alt="" coords="159,57,311,98"/>
<area shape="rect" id="node5" href="ping_8c.html#a4b45bd434660f2737f39189105c0604f" title="check_ping_send_dowork" alt="" coords="149,123,320,149"/>
<area shape="rect" id="node3" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="368,5,453,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1445427854d7b321be538f18802b6b35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_server_poll_remaining_time </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevent__timeout.html">event_timeout</a> *&#160;</td>
          <td class="paramname"><em>server_poll_timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a1445427854d7b321be538f18802b6b35_icgraph.png" border="0" usemap="#forward_8c_a1445427854d7b321be538f18802b6b35_icgraph" alt=""/></div>
<map name="forward_8c_a1445427854d7b321be538f18802b6b35_icgraph" id="forward_8c_a1445427854d7b321be538f18802b6b35_icgraph">
<area shape="rect" id="node2" href="proxy_8h.html#a4fd6cf4c17ae3d718e163b37f0e781df" title="establish_http_proxy\l_passthru" alt="" coords="256,5,399,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae89a1b8349579eb1913fe65253ac81a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void io_wait_dowork </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_ae89a1b8349579eb1913fe65253ac81a1_cgraph.png" border="0" usemap="#forward_8c_ae89a1b8349579eb1913fe65253ac81a1_cgraph" alt=""/></div>
<map name="forward_8c_ae89a1b8349579eb1913fe65253ac81a1_cgraph" id="forward_8c_ae89a1b8349579eb1913fe65253ac81a1_cgraph">
<area shape="rect" id="node2" href="socket_8c.html#ab5605eaa75bdd5f315edcfaefcd77b69" title="socket_set" alt="" coords="183,5,270,32"/>
<area shape="rect" id="node3" href="forward_8h.html#a61c81d8d4c12e17e674876dc802da5e2" title="show_wait_status" alt="" coords="164,56,289,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a98c3703dd840bdc9affca78d893d5024"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pre_select </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a01bb4da24c0d75c32845ac87c5cad055"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> process_incoming_link_part1 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlink__socket__info.html">link_socket_info</a> *&#160;</td>
          <td class="paramname"><em>lsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>floated</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Starts processing a packet read from the external network interface.</p>
<p>This function starts the processing of a data channel packet which has come out of a VPN tunnel. It's high-level structure is as follows:</p><ul>
<li>Verify that a nonzero length packet has been received from a valid source address for the given context <em>c</em>.</li>
<li>Call <code><a class="el" href="ssl_8c.html#ad436aa1372a562e8be84491907531df4">tls_pre_decrypt()</a></code>, which splits data channel and control channel packets:<ul>
<li>If a data channel packet, the appropriate security parameters are loaded.</li>
<li>If a control channel packet, this function process is it and afterwards sets the packet's buffer length to 0, so that the data channel processing steps below will ignore it.</li>
</ul>
</li>
<li>Call <code><a class="el" href="group__data__crypto.html#gae91d99446478fcf3327672eb78ef0bf8">openvpn_decrypt()</a></code> of the <a class="el" href="group__data__crypto.html">Data Channel Crypto module</a> to authenticate and decrypt the packet using the security parameters loaded by <code><a class="el" href="ssl_8c.html#ad436aa1372a562e8be84491907531df4">tls_pre_decrypt()</a></code> above.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure of the VPN tunnel associated with the packet. </td></tr>
    <tr><td class="paramname">lsi</td><td>- <a class="el" href="structlink__socket__info.html">link_socket_info</a> obtained from context before processing. </td></tr>
    <tr><td class="paramname">floated</td><td>- Flag indicates that peer has floated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if packet is authenticated, false otherwise. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a01bb4da24c0d75c32845ac87c5cad055_cgraph.png" border="0" usemap="#forward_8c_a01bb4da24c0d75c32845ac87c5cad055_cgraph" alt=""/></div>
<map name="forward_8c_a01bb4da24c0d75c32845ac87c5cad055_cgraph" id="forward_8c_a01bb4da24c0d75c32845ac87c5cad055_cgraph">
<area shape="rect" id="node2" href="socket_8c.html#a6ebb8e0bd35afb3cda6a0392f1479433" title="proto2ascii" alt="" coords="269,5,354,32"/>
<area shape="rect" id="node3" href="socket_8c.html#aefe5013514f1d62a138107fb43cc74e3" title="print_link_socket_actual" alt="" coords="475,56,637,83"/>
<area shape="rect" id="node11" href="socket_8c.html#abfc81cb26972c5efe7ae96036c1f3881" title="link_socket_bad_incoming_addr" alt="" coords="208,56,415,83"/>
<area shape="rect" id="node12" href="ssl_8c.html#ad436aa1372a562e8be84491907531df4" title="tls_pre_decrypt" alt="" coords="256,391,367,417"/>
<area shape="rect" id="node13" href="ssl_8c.html#a99ae60e6d87c574fb49b45d5de1701ae" title="is_hard_reset" alt="" coords="506,107,606,133"/>
<area shape="rect" id="node26" href="group__data__crypto.html#gae91d99446478fcf3327672eb78ef0bf8" title="openvpn_decrypt" alt="" coords="252,627,371,653"/>
<area shape="rect" id="node29" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="258,677,365,704"/>
<area shape="rect" id="node4" href="socket_8c.html#aa401d7e395acdc1d4f61f6526ef92846" title="print_link_socket_actual_ex" alt="" coords="697,56,880,83"/>
<area shape="rect" id="node5" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="1104,107,1199,133"/>
<area shape="rect" id="node8" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="1114,56,1189,83"/>
<area shape="rect" id="node9" href="socket_8c.html#a616cfadfd81ab5ba341fa3adb1e93788" title="print_sockaddr_ex" alt="" coords="928,5,1056,32"/>
<area shape="rect" id="node6" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="1247,81,1349,108"/>
<area shape="rect" id="node7" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="1257,132,1339,159"/>
<area shape="rect" id="node10" href="buffer_8c.html#a3856237f6bda0d132ed555c23f3b8968" title="buf_puts" alt="" coords="1116,5,1187,32"/>
<area shape="rect" id="node14" href="session__id_8c.html#aa7884bbdd976e0582af7ce08249a5688" title="session_id_print" alt="" coords="731,365,847,392"/>
<area shape="rect" id="node15" href="group__reliable.html#ga14cb4395f780502ae9edbe6d3f90aec5" title="reliable_schedule_now" alt="" coords="480,441,632,468"/>
<area shape="rect" id="node16" href="group__reliable.html#ga03d3c93ec4c15d57947740a56eae0aec" title="reliable_ack_read" alt="" coords="495,340,617,367"/>
<area shape="rect" id="node17" href="group__reliable.html#ga0f79fac5e64e7d2a9df9bc13740f6293" title="reliable_send_purge" alt="" coords="487,492,625,519"/>
<area shape="rect" id="node18" href="group__reliable.html#ga68f5e71b155cdcfabca18d028d336311" title="reliable_can_get" alt="" coords="498,543,614,569"/>
<area shape="rect" id="node19" href="group__reliable.html#ga21a2f2e1296cea87eb6d68331667fc9e" title="reliable_ack_read_packet_id" alt="" coords="463,593,649,620"/>
<area shape="rect" id="node20" href="group__reliable.html#gad2d6e3bde9beced3d69bbba652730439" title="reliable_wont_break\l_sequentiality" alt="" coords="488,645,624,686"/>
<area shape="rect" id="node21" href="group__reliable.html#ga907fd32837c50b4266eb5db1c56f9b13" title="reliable_not_replay" alt="" coords="491,711,621,737"/>
<area shape="rect" id="node22" href="group__reliable.html#gaa69117718f8e1e22881d957e219134ff" title="reliable_get_buf" alt="" coords="500,761,612,788"/>
<area shape="rect" id="node23" href="group__reliable.html#ga2689b44850ce41cc2fe1fc7f57657eb4" title="reliable_mark_active\l_incoming" alt="" coords="487,158,625,199"/>
<area shape="rect" id="node24" href="group__reliable.html#ga3bdc89dd24741d52a2fcf8182389b947" title="reliable_ack_acknowledge\l_packet_id" alt="" coords="469,223,643,265"/>
<area shape="rect" id="node25" href="ssl__backend_8h.html#a163fa38939865554f4d7160a0e426b17" title="tls_clear_error" alt="" coords="504,289,608,316"/>
<area shape="rect" id="node27" href="crypto__backend_8h.html#a21c134671c60f2bc399a5b5a76d7e084" title="cipher_kt_mode_aead" alt="" coords="481,863,631,889"/>
<area shape="rect" id="node28" href="crypto__backend_8h.html#a56d0dd0253f889a5305beb86d2900fe7" title="cipher_ctx_get_cipher_kt" alt="" coords="473,812,639,839"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a28085fcbafd6f128240d96026fd81414"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_incoming_link_part2 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlink__socket__info.html">link_socket_info</a> *&#160;</td>
          <td class="paramname"><em>lsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>orig_buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Continues processing a packet read from the external network interface.</p>
<p>This function continues the processing of a data channel packet which has come out of a VPN tunnel. It must be called after <code><a class="el" href="forward_8h.html#a01bb4da24c0d75c32845ac87c5cad055">process_incoming_link_part1()</a></code> function.</p>
<p>It's high-level structure is as follows:</p><ul>
<li>Call <code>fragment_incoming()</code> of the <a class="el" href="">Data Channel Fragmentation module</a> to reassemble the packet if it's fragmented.</li>
<li>Call <code>lzo_decompress()</code> of the <a class="el" href="">Data Channel Compression module</a> to decompress the packet if it's compressed.</li>
<li>Place the resulting packet in <code>c-&gt;c2.to_tun</code> so that it can be sent over the virtual tun/tap network interface to its local destination by the <a class="el" href="">Internal Multiplexer</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure of the VPN tunnel associated with the packet. </td></tr>
    <tr><td class="paramname">lsi</td><td>- <a class="el" href="structlink__socket__info.html">link_socket_info</a> obtained from context before processing. </td></tr>
    <tr><td class="paramname">orig_buf</td><td>- Pointer to a buffer data. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a28085fcbafd6f128240d96026fd81414_cgraph.png" border="0" usemap="#forward_8c_a28085fcbafd6f128240d96026fd81414_cgraph" alt=""/></div>
<map name="forward_8c_a28085fcbafd6f128240d96026fd81414_cgraph" id="forward_8c_a28085fcbafd6f128240d96026fd81414_cgraph">
<area shape="rect" id="node2" href="occ_8c.html#a4e230d2f9a3d4523316bf229c03b2b0d" title="process_received_occ_msg" alt="" coords="208,56,391,83"/>
<area shape="rect" id="node3" href="options_8c.html#a6f0600deb648f062f2b342dc3023c3c8" title="options_cmp_equal_safe" alt="" coords="439,5,604,32"/>
<area shape="rect" id="node4" href="options_8c.html#a88b712229ca2858be056ba50ab78a8a4" title="options_warning_safe" alt="" coords="448,56,595,83"/>
<area shape="rect" id="node5" href="socket_8c.html#adbff197bdb9734118cdf9889650477ae" title="proto_is_dgram" alt="" coords="466,107,577,133"/>
<area shape="rect" id="node6" href="socket_8c.html#a86424bdc75e8f05f00a649f30f897110" title="proto_is_udp" alt="" coords="652,107,748,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1ac8de3ee1c24f16d30a8773d7574bee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_incoming_tun </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process a packet read from the virtual tun/tap network interface.</p>
<p>This function calls <code><a class="el" href="forward_8h.html#a66abf1cd0cfe2af99b61d954cab37966">encrypt_sign()</a></code> of the <a class="el" href="">Data Channel Control module</a> to process the packet.</p>
<p>If an error occurs, it is logged and the packet is dropped.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure of the VPN tunnel associated with the packet. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_cgraph.png" border="0" usemap="#forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_cgraph" alt=""/></div>
<map name="forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_cgraph" id="forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_cgraph">
<area shape="rect" id="node2" href="forward_8c.html#a9d9ddd3cb647f519e56209e58fb09610" title="process_ip_header" alt="" coords="205,199,336,225"/>
<area shape="rect" id="node16" href="forward_8c.html#a66abf1cd0cfe2af99b61d954cab37966" title="encrypt_sign" alt="" coords="223,452,319,479"/>
<area shape="rect" id="node3" href="proto_8c.html#a3ff585140c0be911484f65149af51e34" title="is_ipv4" alt="" coords="438,275,499,301"/>
<area shape="rect" id="node4" href="mss_8c.html#a97f1f8f283390625cf3a6fe362f991a5" title="mss_fixup_ipv4" alt="" coords="413,325,524,352"/>
<area shape="rect" id="node6" href="clinat_8c.html#a52bde34f5246b0b54699d6ce2e0352b4" title="client_nat_transform" alt="" coords="399,5,538,32"/>
<area shape="rect" id="node7" href="dhcp_8c.html#a0e845631a332310acc8cd259eaf6d0f6" title="dhcp_extract_router_msg" alt="" coords="384,56,553,83"/>
<area shape="rect" id="node13" href="route_8c.html#a7306bd6298ac341522df4f697527e59b" title="route_list_add_vpn\l_gateway" alt="" coords="404,107,533,149"/>
<area shape="rect" id="node14" href="proto_8c.html#a53a4b0598de56c3bf4497c30253c5596" title="is_ipv6" alt="" coords="438,173,499,200"/>
<area shape="rect" id="node15" href="mss_8c.html#a7a5a47f5ac568a784816b0f8bf20be81" title="mss_fixup_ipv6" alt="" coords="413,224,524,251"/>
<area shape="rect" id="node5" href="mss_8c.html#a21222acb54e33e11135a9fbdf4b02b53" title="mss_fixup_dowork" alt="" coords="620,275,749,301"/>
<area shape="rect" id="node8" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61" title="print_in_addr_t" alt="" coords="631,56,738,83"/>
<area shape="rect" id="node9" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="816,31,911,57"/>
<area shape="rect" id="node12" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="826,81,901,108"/>
<area shape="rect" id="node10" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="959,5,1061,32"/>
<area shape="rect" id="node11" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="969,56,1051,83"/>
<area shape="rect" id="node17" href="group__data__crypto.html#gaba03eaba587a89c2abda8780da7b3ac7" title="tls_pre_encrypt" alt="" coords="413,477,524,504"/>
<area shape="rect" id="node18" href="group__data__crypto.html#gad27b20736f89d38d0d2e0c2e35f7a0e3" title="tls_prepend_opcode_v2" alt="" coords="390,528,547,555"/>
<area shape="rect" id="node19" href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9" title="openvpn_encrypt" alt="" coords="409,579,528,605"/>
<area shape="rect" id="node22" href="group__data__crypto.html#gaac2b3aa2c842a102804be65f28adf4b1" title="tls_prepend_opcode_v1" alt="" coords="390,376,547,403"/>
<area shape="rect" id="node23" href="group__data__crypto.html#ga1f2ecd39b88da77b2f8067962155ea82" title="tls_post_encrypt" alt="" coords="409,427,528,453"/>
<area shape="rect" id="node20" href="crypto__backend_8h.html#a56d0dd0253f889a5305beb86d2900fe7" title="cipher_ctx_get_cipher_kt" alt="" coords="601,553,768,580"/>
<area shape="rect" id="node21" href="crypto__backend_8h.html#a21c134671c60f2bc399a5b5a76d7e084" title="cipher_kt_mode_aead" alt="" coords="610,604,759,631"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_icgraph.png" border="0" usemap="#forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_icgraph" alt=""/></div>
<map name="forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_icgraph" id="forward_8c_a1ac8de3ee1c24f16d30a8773d7574bee_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="205,5,291,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a20db9c6797042b6584e95af8ea5bbc10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_io </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a20db9c6797042b6584e95af8ea5bbc10_cgraph.png" border="0" usemap="#forward_8c_a20db9c6797042b6584e95af8ea5bbc10_cgraph" alt=""/></div>
<map name="forward_8c_a20db9c6797042b6584e95af8ea5bbc10_cgraph" id="forward_8c_a20db9c6797042b6584e95af8ea5bbc10_cgraph">
<area shape="rect" id="node2" href="forward_8c.html#a1a506b271590be59a1b285c6cd4a5d85" title="process_outgoing_link" alt="" coords="139,93,290,120"/>
<area shape="rect" id="node13" href="forward_8c.html#a2dd6f53fabe65e8e50eafc12030a8a6e" title="process_outgoing_tun" alt="" coords="140,271,289,297"/>
<area shape="rect" id="node25" href="forward_8c.html#ab240cf830443447e24d8554e7b290446" title="read_incoming_link" alt="" coords="148,169,281,196"/>
<area shape="rect" id="node27" href="forward_8c.html#a085f2884d6c0e63250ad17e489ab2a1e" title="read_incoming_tun" alt="" coords="149,220,280,247"/>
<area shape="rect" id="node29" href="forward_8c.html#a1ac8de3ee1c24f16d30a8773d7574bee" title="process_incoming_tun" alt="" coords="139,321,291,348"/>
<area shape="rect" id="node3" href="socket_8c.html#a6ebb8e0bd35afb3cda6a0392f1479433" title="proto2ascii" alt="" coords="377,17,463,44"/>
<area shape="rect" id="node4" href="socket_8c.html#aefe5013514f1d62a138107fb43cc74e3" title="print_link_socket_actual" alt="" coords="339,68,501,95"/>
<area shape="rect" id="node12" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="367,169,473,196"/>
<area shape="rect" id="node5" href="socket_8c.html#aa401d7e395acdc1d4f61f6526ef92846" title="print_link_socket_actual_ex" alt="" coords="549,64,732,91"/>
<area shape="rect" id="node6" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="995,56,1089,83"/>
<area shape="rect" id="node9" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="1005,107,1079,133"/>
<area shape="rect" id="node10" href="socket_8c.html#a616cfadfd81ab5ba341fa3adb1e93788" title="print_sockaddr_ex" alt="" coords="799,56,927,83"/>
<area shape="rect" id="node7" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="1137,31,1240,57"/>
<area shape="rect" id="node8" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="1148,81,1229,108"/>
<area shape="rect" id="node11" href="buffer_8c.html#a3856237f6bda0d132ed555c23f3b8968" title="buf_puts" alt="" coords="1007,5,1077,32"/>
<area shape="rect" id="node14" href="forward_8c.html#a9d9ddd3cb647f519e56209e58fb09610" title="process_ip_header" alt="" coords="355,321,485,348"/>
<area shape="rect" id="node24" href="tun_8c.html#afdac6b3217749dccb863f9dc39818b9d" title="write_tun" alt="" coords="383,271,457,297"/>
<area shape="rect" id="node15" href="proto_8c.html#a3ff585140c0be911484f65149af51e34" title="is_ipv4" alt="" coords="610,372,671,399"/>
<area shape="rect" id="node16" href="mss_8c.html#a97f1f8f283390625cf3a6fe362f991a5" title="mss_fixup_ipv4" alt="" coords="585,423,696,449"/>
<area shape="rect" id="node18" href="clinat_8c.html#a52bde34f5246b0b54699d6ce2e0352b4" title="client_nat_transform" alt="" coords="571,473,710,500"/>
<area shape="rect" id="node19" href="dhcp_8c.html#a0e845631a332310acc8cd259eaf6d0f6" title="dhcp_extract_router_msg" alt="" coords="556,153,725,180"/>
<area shape="rect" id="node21" href="route_8c.html#a7306bd6298ac341522df4f697527e59b" title="route_list_add_vpn\l_gateway" alt="" coords="576,205,705,246"/>
<area shape="rect" id="node22" href="proto_8c.html#a53a4b0598de56c3bf4497c30253c5596" title="is_ipv6" alt="" coords="610,271,671,297"/>
<area shape="rect" id="node23" href="mss_8c.html#a7a5a47f5ac568a784816b0f8bf20be81" title="mss_fixup_ipv6" alt="" coords="585,321,696,348"/>
<area shape="rect" id="node17" href="mss_8c.html#a21222acb54e33e11135a9fbdf4b02b53" title="mss_fixup_dowork" alt="" coords="799,372,928,399"/>
<area shape="rect" id="node20" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61" title="print_in_addr_t" alt="" coords="810,157,917,184"/>
<area shape="rect" id="node26" href="manage_8c.html#af07a56f96cec84856d0bf97899a4d460" title="management_sleep" alt="" coords="353,119,487,145"/>
<area shape="rect" id="node28" href="tun_8c.html#ac75f33ac5fe746f7bf5733d9e8c67bf2" title="read_tun" alt="" coords="384,220,456,247"/>
<area shape="rect" id="node30" href="forward_8c.html#a66abf1cd0cfe2af99b61d954cab37966" title="encrypt_sign" alt="" coords="372,600,468,627"/>
<area shape="rect" id="node31" href="group__data__crypto.html#gaba03eaba587a89c2abda8780da7b3ac7" title="tls_pre_encrypt" alt="" coords="585,727,696,753"/>
<area shape="rect" id="node32" href="group__data__crypto.html#gad27b20736f89d38d0d2e0c2e35f7a0e3" title="tls_prepend_opcode_v2" alt="" coords="562,524,719,551"/>
<area shape="rect" id="node33" href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9" title="openvpn_encrypt" alt="" coords="581,575,700,601"/>
<area shape="rect" id="node36" href="group__data__crypto.html#gaac2b3aa2c842a102804be65f28adf4b1" title="tls_prepend_opcode_v1" alt="" coords="562,625,719,652"/>
<area shape="rect" id="node37" href="group__data__crypto.html#ga1f2ecd39b88da77b2f8067962155ea82" title="tls_post_encrypt" alt="" coords="581,676,700,703"/>
<area shape="rect" id="node34" href="crypto__backend_8h.html#a56d0dd0253f889a5305beb86d2900fe7" title="cipher_ctx_get_cipher_kt" alt="" coords="780,600,947,627"/>
<area shape="rect" id="node35" href="crypto__backend_8h.html#a21c134671c60f2bc399a5b5a76d7e084" title="cipher_kt_mode_aead" alt="" coords="789,549,938,576"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9d9ddd3cb647f519e56209e58fb09610"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_ip_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a9d9ddd3cb647f519e56209e58fb09610_cgraph.png" border="0" usemap="#forward_8c_a9d9ddd3cb647f519e56209e58fb09610_cgraph" alt=""/></div>
<map name="forward_8c_a9d9ddd3cb647f519e56209e58fb09610_cgraph" id="forward_8c_a9d9ddd3cb647f519e56209e58fb09610_cgraph">
<area shape="rect" id="node2" href="proto_8c.html#a3ff585140c0be911484f65149af51e34" title="is_ipv4" alt="" coords="238,5,299,32"/>
<area shape="rect" id="node3" href="mss_8c.html#a97f1f8f283390625cf3a6fe362f991a5" title="mss_fixup_ipv4" alt="" coords="213,157,324,184"/>
<area shape="rect" id="node5" href="clinat_8c.html#a52bde34f5246b0b54699d6ce2e0352b4" title="client_nat_transform" alt="" coords="199,107,338,133"/>
<area shape="rect" id="node6" href="dhcp_8c.html#a0e845631a332310acc8cd259eaf6d0f6" title="dhcp_extract_router_msg" alt="" coords="184,56,353,83"/>
<area shape="rect" id="node12" href="route_8c.html#a7306bd6298ac341522df4f697527e59b" title="route_list_add_vpn\l_gateway" alt="" coords="204,209,333,250"/>
<area shape="rect" id="node13" href="proto_8c.html#a53a4b0598de56c3bf4497c30253c5596" title="is_ipv6" alt="" coords="238,275,299,301"/>
<area shape="rect" id="node14" href="mss_8c.html#a7a5a47f5ac568a784816b0f8bf20be81" title="mss_fixup_ipv6" alt="" coords="213,325,324,352"/>
<area shape="rect" id="node4" href="mss_8c.html#a21222acb54e33e11135a9fbdf4b02b53" title="mss_fixup_dowork" alt="" coords="401,241,531,268"/>
<area shape="rect" id="node7" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61" title="print_in_addr_t" alt="" coords="413,56,519,83"/>
<area shape="rect" id="node8" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="579,31,673,57"/>
<area shape="rect" id="node11" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="589,81,663,108"/>
<area shape="rect" id="node9" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="721,5,824,32"/>
<area shape="rect" id="node10" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="732,56,813,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a9d9ddd3cb647f519e56209e58fb09610_icgraph.png" border="0" usemap="#forward_8c_a9d9ddd3cb647f519e56209e58fb09610_icgraph" alt=""/></div>
<map name="forward_8c_a9d9ddd3cb647f519e56209e58fb09610_icgraph" id="forward_8c_a9d9ddd3cb647f519e56209e58fb09610_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a1ac8de3ee1c24f16d30a8773d7574bee" title="process_incoming_tun" alt="" coords="184,5,336,32"/>
<area shape="rect" id="node4" href="forward_8h.html#a2dd6f53fabe65e8e50eafc12030a8a6e" title="process_outgoing_tun" alt="" coords="185,56,335,83"/>
<area shape="rect" id="node3" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="384,31,469,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a506b271590be59a1b285c6cd4a5d85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_outgoing_link </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a packet to the external network interface.</p>
<p>This function writes the packet stored in <code>c-&gt;c2.to_link</code> to the external network device contained within <code>c-&gt;c1.link_socket</code>.</p>
<p>If an error occurs, it is logged and the packet is dropped.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure of the VPN tunnel associated with the packet. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a1a506b271590be59a1b285c6cd4a5d85_cgraph.png" border="0" usemap="#forward_8c_a1a506b271590be59a1b285c6cd4a5d85_cgraph" alt=""/></div>
<map name="forward_8c_a1a506b271590be59a1b285c6cd4a5d85_cgraph" id="forward_8c_a1a506b271590be59a1b285c6cd4a5d85_cgraph">
<area shape="rect" id="node2" href="socket_8c.html#a6ebb8e0bd35afb3cda6a0392f1479433" title="proto2ascii" alt="" coords="243,31,328,57"/>
<area shape="rect" id="node3" href="socket_8c.html#aefe5013514f1d62a138107fb43cc74e3" title="print_link_socket_actual" alt="" coords="204,81,367,108"/>
<area shape="rect" id="node11" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="232,132,339,159"/>
<area shape="rect" id="node4" href="socket_8c.html#aa401d7e395acdc1d4f61f6526ef92846" title="print_link_socket_actual_ex" alt="" coords="415,81,597,108"/>
<area shape="rect" id="node5" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="821,31,916,57"/>
<area shape="rect" id="node8" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="831,132,906,159"/>
<area shape="rect" id="node9" href="socket_8c.html#a616cfadfd81ab5ba341fa3adb1e93788" title="print_sockaddr_ex" alt="" coords="645,81,773,108"/>
<area shape="rect" id="node6" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="964,5,1067,32"/>
<area shape="rect" id="node7" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="975,56,1056,83"/>
<area shape="rect" id="node10" href="buffer_8c.html#a3856237f6bda0d132ed555c23f3b8968" title="buf_puts" alt="" coords="833,81,904,108"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a1a506b271590be59a1b285c6cd4a5d85_icgraph.png" border="0" usemap="#forward_8c_a1a506b271590be59a1b285c6cd4a5d85_icgraph" alt=""/></div>
<map name="forward_8c_a1a506b271590be59a1b285c6cd4a5d85_icgraph" id="forward_8c_a1a506b271590be59a1b285c6cd4a5d85_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="204,5,289,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2dd6f53fabe65e8e50eafc12030a8a6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_outgoing_tun </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a packet to the virtual tun/tap network interface.</p>
<p>This function writes the packet stored in <code>c-&gt;c2.to_tun</code> to the virtual tun/tap network device <code>c-&gt;c1.tuntap</code>.</p>
<p>If an error occurs, it is logged and the packet is dropped.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure of the VPN tunnel associated with the packet. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_cgraph.png" border="0" usemap="#forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_cgraph" alt=""/></div>
<map name="forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_cgraph" id="forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_cgraph">
<area shape="rect" id="node2" href="forward_8c.html#a9d9ddd3cb647f519e56209e58fb09610" title="process_ip_header" alt="" coords="203,157,333,184"/>
<area shape="rect" id="node16" href="tun_8c.html#afdac6b3217749dccb863f9dc39818b9d" title="write_tun" alt="" coords="231,208,305,235"/>
<area shape="rect" id="node3" href="proto_8c.html#a3ff585140c0be911484f65149af51e34" title="is_ipv4" alt="" coords="435,5,497,32"/>
<area shape="rect" id="node4" href="mss_8c.html#a97f1f8f283390625cf3a6fe362f991a5" title="mss_fixup_ipv4" alt="" coords="411,157,521,184"/>
<area shape="rect" id="node6" href="clinat_8c.html#a52bde34f5246b0b54699d6ce2e0352b4" title="client_nat_transform" alt="" coords="397,107,535,133"/>
<area shape="rect" id="node7" href="dhcp_8c.html#a0e845631a332310acc8cd259eaf6d0f6" title="dhcp_extract_router_msg" alt="" coords="381,56,551,83"/>
<area shape="rect" id="node13" href="route_8c.html#a7306bd6298ac341522df4f697527e59b" title="route_list_add_vpn\l_gateway" alt="" coords="401,209,531,250"/>
<area shape="rect" id="node14" href="proto_8c.html#a53a4b0598de56c3bf4497c30253c5596" title="is_ipv6" alt="" coords="435,275,497,301"/>
<area shape="rect" id="node15" href="mss_8c.html#a7a5a47f5ac568a784816b0f8bf20be81" title="mss_fixup_ipv6" alt="" coords="411,325,521,352"/>
<area shape="rect" id="node5" href="mss_8c.html#a21222acb54e33e11135a9fbdf4b02b53" title="mss_fixup_dowork" alt="" coords="599,241,728,268"/>
<area shape="rect" id="node8" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61" title="print_in_addr_t" alt="" coords="610,56,717,83"/>
<area shape="rect" id="node9" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c" title="alloc_buf_gc" alt="" coords="776,31,871,57"/>
<area shape="rect" id="node12" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a" title="buf_printf" alt="" coords="786,81,861,108"/>
<area shape="rect" id="node10" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="919,5,1021,32"/>
<area shape="rect" id="node11" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="929,56,1011,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_icgraph.png" border="0" usemap="#forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_icgraph" alt=""/></div>
<map name="forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_icgraph" id="forward_8c_a2dd6f53fabe65e8e50eafc12030a8a6e_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="203,5,288,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab240cf830443447e24d8554e7b290446"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_incoming_link </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a packet from the external network interface.</p>
<p>The packet read from the external network interface is stored in <code>c-&gt;c2.buf</code> and its source address in <code>c-&gt;c2.from</code>. If an error occurred, the length of <code>c-&gt;c2.buf</code> will be 0.</p>
<p>OpenVPN running as client or as UDP server only has a single external network socket, so this function can be called with the single (client mode) or top level (UDP server) context as its argument. OpenVPN running as TCP server, on the other hand, has a network socket for each active VPN tunnel. In that case this function must be called with the context associated with the appropriate VPN tunnel for which data is available to be read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure which contains the external network socket from which to read incoming packets. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_ab240cf830443447e24d8554e7b290446_cgraph.png" border="0" usemap="#forward_8c_ab240cf830443447e24d8554e7b290446_cgraph" alt=""/></div>
<map name="forward_8c_ab240cf830443447e24d8554e7b290446_cgraph" id="forward_8c_ab240cf830443447e24d8554e7b290446_cgraph">
<area shape="rect" id="node2" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="201,5,307,32"/>
<area shape="rect" id="node3" href="manage_8c.html#af07a56f96cec84856d0bf97899a4d460" title="management_sleep" alt="" coords="187,56,321,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_ab240cf830443447e24d8554e7b290446_icgraph.png" border="0" usemap="#forward_8c_ab240cf830443447e24d8554e7b290446_icgraph" alt=""/></div>
<map name="forward_8c_ab240cf830443447e24d8554e7b290446_icgraph" id="forward_8c_ab240cf830443447e24d8554e7b290446_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="187,5,272,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a085f2884d6c0e63250ad17e489ab2a1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_incoming_tun </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a packet from the virtual tun/tap network interface.</p>
<p>This function reads a packet from the virtual tun/tap network device <code>c-&gt;c1.tuntap</code> and stores it in <code>c-&gt;c2.buf</code>.</p>
<p>If an error occurs, it is logged and the packet is dropped.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>- The context structure in which to store the received packet. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_cgraph.png" border="0" usemap="#forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_cgraph" alt=""/></div>
<map name="forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_cgraph" id="forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_cgraph">
<area shape="rect" id="node2" href="tun_8c.html#ac75f33ac5fe746f7bf5733d9e8c67bf2" title="read_tun" alt="" coords="201,5,273,32"/>
<area shape="rect" id="node3" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417" title="register_signal" alt="" coords="184,56,291,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_icgraph.png" border="0" usemap="#forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_icgraph" alt=""/></div>
<map name="forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_icgraph" id="forward_8c_a085f2884d6c0e63250ad17e489ab2a1e_icgraph">
<area shape="rect" id="node2" href="forward_8h.html#a20db9c6797042b6584e95af8ea5bbc10" title="process_io" alt="" coords="184,5,269,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7a409db050be184362b60f3ce7b56b35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="automatic_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> send_control_channel_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>msglevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="forward_8c_a7a409db050be184362b60f3ce7b56b35_cgraph.png" border="0" usemap="#forward_8c_a7a409db050be184362b60f3ce7b56b35_cgraph" alt=""/></div>
<map name="forward_8c_a7a409db050be184362b60f3ce7b56b35_cgraph" id="forward_8c_a7a409db050be184362b60f3ce7b56b35_cgraph">
<area shape="rect" id="node2" href="ssl_8c.html#af2bd825809313e721a9f2d219ad59ecd" title="tls_send_payload" alt="" coords="227,123,349,149"/>
<area shape="rect" id="node9" href="ssl__verify_8c.html#af3b8a3f413dbfc086e05cc5b09efb998" title="tls_common_name" alt="" coords="222,173,354,200"/>
<area shape="rect" id="node10" href="misc_8c.html#ad9f9ea2091b3303cef77c02575fdf91d" title="sanitize_control_message" alt="" coords="201,224,375,251"/>
<area shape="rect" id="node3" href="ssl__backend_8h.html#a163fa38939865554f4d7160a0e426b17" title="tls_clear_error" alt="" coords="455,5,559,32"/>
<area shape="rect" id="node4" href="group__control__tls.html#ga67dac3b75328d8b92d3f1a69e86dacdc" title="key_state_write_plaintext\l_const" alt="" coords="423,57,592,98"/>
<area shape="rect" id="node5" href="buffer_8c.html#a802172b567a3ac89a544452fe02a45bf" title="buffer_list_new" alt="" coords="454,123,561,149"/>
<area shape="rect" id="node6" href="buffer_8c.html#a21d180a3513a60a724ec43cbf30cb759" title="buffer_list_push_data" alt="" coords="435,173,579,200"/>
<area shape="rect" id="node7" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51" title="alloc_buf" alt="" coords="640,173,713,200"/>
<area shape="rect" id="node8" href="buffer_8c.html#acc1a4ee83a591116d331e52baacf253d" title="buf_size_error" alt="" coords="761,173,864,200"/>
<area shape="rect" id="node11" href="buffer_8c.html#a67f7dec7f86e113dc0744584fd80b621" title="gc_malloc" alt="" coords="467,224,548,251"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ae0b0b85c9002d7df1fc4de4352a7c3e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a> link_read_bytes_global</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0bd9d43482b20b7440a8d265c611a35c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a> link_write_bytes_global</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
